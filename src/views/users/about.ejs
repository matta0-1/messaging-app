<% layout='layout' %>
    <% title='About' %>
        <% if (notification) { %>
            <div id="notificationAlert" class="alert alert-success alert-dismissible fade show" role="alert"
                style="position: fixed; top: 20px; left: 50%; transform: translateX(-50%);">
                <%= notification %>
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            <% } %>

                <div>
                    <h1>Your personal info:</h1>

                    <h2>Username: <%= user.username %>
                    </h2>
                    <h2>First name: <%= user.firstName %>
                    </h2>
                    <h2>Last name: <%= user.lastName %>
                    </h2>
                    <h2>Email: <%= user.email %>
                    </h2>
                    <div>
                        <form action="/users/change-email" method="GET" style="display:inline;">
                            <button type="submit" class="btn btn-secondary">
                                Change email
                            </button>
                        </form>
                    </div>

                    <div>
                        <form action="/users/change-password" method="GET" style="display:inline;">
                            <button type="submit" class="btn btn-secondary">
                                Change password
                            </button>
                        </form>
                    </div>


                    <h2>User since:
                        <% const sentDate=new Date(user.createdAt); %>
                            <%= sentDate.toLocaleDateString("en-US", { weekday: "long" , year: "numeric" , month: "long"
                                , day: "numeric" }); %>
                    </h2>
                </div>

                <div>
                    <form action="/auth/logout" method="POST" style="display:inline;">
                        <button type="submit" class="btn btn-secondary">
                            Log out
                        </button>
                    </form>
                </div>
                <div>
                    <form class="delete-form"
                        messageForConfirm="delete your account (This action cannot be reversed and will permanently delete all your conversations)"
                        action="/users" method="POST" style="display:inline;">
                        <input type="hidden" name="_method" value="DELETE">
                        <button type="submit" class="btn btn-danger">
                            Delete account
                        </button>
                    </form>
                </div>

                <script>
                    document.addEventListener("DOMContentLoaded", function () {
                        const alert = document.getElementById("notificationAlert");
                        if (alert) {
                            setTimeout(() => {
                                const bsAlert = new bootstrap.Alert(alert);
                                bsAlert.close();
                            }, 2000);
                        }
                    });
                </script>
