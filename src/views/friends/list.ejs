<% layout='layout' %>
    <% title='Friends' %>
        <div>
            <h1>Here are your friends, <%= user.username %>:</h1>
        </div>

        <div>
            <p>
                <% if (acceptedFriends && acceptedFriends.length > 0) { %>
                    <h2>Current friends:</h2>
                    <table class="table table-striped table-hover align-middle mt-3">
                        <thead class="table-primary">
                            <tr>
                                <th>Username</th>
                                <th></th>
                                <th>Actions</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <% acceptedFriends.forEach(friend=> { %>
                                <tr>
                                    <td>
                                        <%=friend.username %>
                                    </td>
                                    <td><a href="/messages/<%= friend.id%>" class="btn btn-primary">Chat</a></td>

                                    <td>
                                        <form action="/friends/block/<%= friend.id %>" method="POST"
                                            style="display:inline;">
                                            <input type="hidden" name="_method" value="PUT">
                                            <input type="hidden" name="redirect" value="friends">
                                            <button type="submit" class="btn btn-warning"> Block </button>
                                        </form>
                                    </td>

                                    <td>
                                        <form class="delete-form"
                                            messageForConfirm="remove <%= friend.username %> from your friend list"
                                            action="/friends/delete/<%= friend.id%>" method="POST"
                                            style="display:inline;">
                                            <input type="hidden" name="_method" value="DELETE">
                                            <input type="hidden" name="redirect" value="friends">
                                            <button type="submit" class="btn btn-danger">
                                                Delete
                                            </button>
                                        </form>
                                    </td>
                                </tr>

                                <%})%>
                        </tbody>
                    </table>
                    <%} else { %>
                        <h2>You currently have no friends. Add some!!</h2>
                        <%}%>
            </p>


            <p>
                <% if (pendingFriends && pendingFriends.length> 0) { %>
                    <h2>Pending friends:</h2>
                    <table class="table table-striped table-hover align-middle mt-3">
                        <thead class="table-primary">
                            <tr>
                                <th>Username</th>
                                <th></th>
                                <th>Actions</th>
                                <th></th>
                            </tr>
                        </thead>
                        <% pendingFriends.forEach(friend=> { %>
                            <tr>
                                <td>
                                    <%=friend.username %>
                                </td>

                                <td>
                                    <form action="/friends/accept/<%= friend.id %>" method="POST"
                                        style="display:inline;">
                                        <input type="hidden" name="_method" value="PUT">
                                        <input type="hidden" name="redirect" value="friends">
                                        <button type="submit" class="btn btn-primary"> Accept </button>
                                    </form>
                                </td>

                                <td>
                                    <form action="/friends/block/<%= friend.id %>" method="POST"
                                        style="display:inline;">
                                        <input type="hidden" name="_method" value="PUT">
                                        <input type="hidden" name="redirect" value="friends">
                                        <button type="submit" class="btn btn-warning"> Block </button>
                                    </form>
                                </td>

                                <td>
                                    <form class="delete-form"
                                        messageForConfirm="remove <%= friend.username %> from your friend list"
                                        action="/friends/delete/<%= friend.id%>" method="POST" style="display:inline;">
                                        <input type="hidden" name="_method" value="DELETE">
                                        <input type="hidden" name="redirect" value="friends">
                                        <button type="submit" class="btn btn-danger">
                                            Delete
                                        </button>
                                    </form>
                                </td>
                            </tr>
                            <%})%>
                    </table>
                    <!-- <%// } else { %>
                        <h5>No pending friend requests</h5>
                        <% // }%> -->
                    <% } %>
            </p>

            <p>
                <% if (blockedFriends && blockedFriends.length> 0) { %>
                    <h2>Blocked friends:</h2>
                    <table class="table table-striped table-hover align-middle mt-3">
                        <thead class="table-primary">
                            <tr>
                                <th>Username</th>

                                <th>Actions</th>
                                <th></th>

                            </tr>
                        </thead>
                        <% blockedFriends.forEach(friend=> { %>
                            <tr>
                                <td>
                                    <%=friend.username %>
                                </td>

                                <td>
                                    <form action="/friends/accept/<%= friend.id %>" method="POST"
                                        style="display:inline;">
                                        <input type="hidden" name="_method" value="PUT">
                                        <input type="hidden" name="redirect" value="friends">
                                        <button type="submit" class="btn btn-primary">Unblock</button>
                                    </form>
                                </td>

                                <td>
                                    <form class="delete-form"
                                        messageForConfirm="remove <%= friend.username %> from your friend list"
                                        action="/friends/delete/<%= friend.id%>" method="POST" style="display:inline;">
                                        <input type="hidden" name="_method" value="DELETE">
                                        <input type="hidden" name="redirect" value="friends">
                                        <button type="submit" class="btn btn-danger">Delete</button>
                                    </form>
                                </td>
                            </tr>
                            <%})%>
                    </table>
                    <!-- <%// } else { %>
                        <h5>No blocked friend requests</h5>
                        <% // }%> -->
                    <% } %>
            </p>
        </div>

        <p>
        <div>
            <h3>Find new Friends!</h3>
            <a href="/users/all" class="btn btn-primary">See all users</a>
            <a href="/users/search" class="btn btn-primary">Search</a>
        </div>
        </p>
